import{u as T,r as c,j as e,t as B}from"./index-Bpmg-vmN.js";import{C as t,d as r,a as v,b as y,c as R}from"./card-C61QVjmC.js";import{u as q,B as j,s as b}from"./useAuth-B7xzxMws.js";import{P as z}from"./progress-C8dqURU4.js";import{Z as w,M as E,B as H}from"./badge-CHKu4n1O.js";import{A as S,S as M,C as g,a as L}from"./AuthGuard-DoTSIcZu.js";import{A as I}from"./AppNavigation-D3r1DcPC.js";import{C as _}from"./clock-DBSZbB5A.js";import{B as p}from"./book-open-BtRnualg.js";import{a as K,T as Q}from"./trending-up-BWhUt7R1.js";import{B as U}from"./brain-BrnCoGwW.js";const te=()=>{const{user:d}=q(),m=T(),[l,f]=c.useState([]),[o,N]=c.useState([]),[k,C]=c.useState(!0),[D,A]=c.useState(0),P=()=>{A(s=>s+1)};c.useEffect(()=>{(async()=>{if(d)try{const{data:a,error:u}=await b.from("user_progress").select("*").eq("user_id",d.id).order("progress_percentage",{ascending:!1}).limit(5);f(u?[]:a||[]);const{data:i,error:n}=await b.from("study_sessions").select("topic, created_at, duration_minutes, session_type").eq("user_id",d.id).order("created_at",{ascending:!1}).limit(5);N(n?[]:i||[])}catch{B({title:"Error",description:"Failed to load dashboard data.",variant:"destructive"})}finally{C(!1)}})()},[d,D]);const x=(()=>{const s=o.reduce((i,n)=>i+n.duration_minutes,0),a=new Set(l.map(i=>i.topic)).size,u=l.length>0?Math.round(l.reduce((i,n)=>i+n.progress_percentage,0)/l.length):0;return{studyHours:Math.round(s/60),topicsStudied:a,averageProgress:u,totalSessions:o.length}})(),h=s=>{switch(s){case"ai-tutor":m("/tutor");break;case"quiz":m("/quizzes");break;case"planner":m("/planner");break}};return k?e.jsx(S,{children:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}):e.jsx(S,{children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(I,{}),e.jsxs("div",{className:"flex",children:[e.jsx(M,{}),e.jsx("div",{className:"flex-1 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Welcome back! Here's your learning progress."})]}),e.jsxs(j,{variant:"outline",onClick:P,children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Refresh Data"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(t,{className:"hover:shadow-lg transition-shadow",children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Study Hours"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:x.studyHours}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+2.5 from last week"})]}),e.jsx(_,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(t,{className:"hover:shadow-lg transition-shadow",children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Topics Studied"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:x.topicsStudied}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+3 new topics"})]}),e.jsx(p,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(t,{className:"hover:shadow-lg transition-shadow",children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Progress"}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[x.averageProgress,"%"]}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+12% improvement"})]}),e.jsx(K,{className:"w-8 h-8 text-yellow-600"})]})})}),e.jsx(t,{className:"hover:shadow-lg transition-shadow",children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Study Sessions"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:x.totalSessions}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"7-day streak"})]}),e.jsx(w,{className:"w-8 h-8 text-purple-600"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(t,{className:"cursor-pointer hover:shadow-lg transition-all",onClick:()=>h("ai-tutor"),children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(E,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"AI Tutor"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Chat with your AI study buddy"})]})]}),e.jsx(g,{className:"w-4 h-4 text-muted-foreground"})]})})}),e.jsx(t,{className:"cursor-pointer hover:shadow-lg transition-all",onClick:()=>h("quiz"),children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(U,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Take Quiz"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Test your knowledge"})]})]}),e.jsx(g,{className:"w-4 h-4 text-muted-foreground"})]})})}),e.jsx(t,{className:"cursor-pointer hover:shadow-lg transition-all",onClick:()=>h("planner"),children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Study Planner"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Plan your study schedule"})]})]}),e.jsx(g,{className:"w-4 h-4 text-muted-foreground"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),"Learning Progress"]})}),e.jsx(r,{className:"space-y-4",children:l.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(p,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No progress data yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start studying to see your progress!"}),e.jsx(j,{className:"mt-4",children:"Start Learning"})]}):l.map((s,a)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsxs("span",{className:"font-medium",children:[s.subject," - ",s.topic]}),e.jsxs("span",{children:[s.progress_percentage,"%"]})]}),e.jsx(z,{value:s.progress_percentage,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Math.round(s.total_study_time_minutes/60)," hours studied"]})]},a))})]}),e.jsxs(t,{children:[e.jsxs(v,{children:[e.jsx(y,{children:"Recent Activity"}),e.jsx(R,{children:"Your latest learning activities"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(_,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No recent activity"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start a study session to see your activity!"}),e.jsx(j,{className:"mt-4",children:"Start Studying"})]}):o.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-border last:border-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(p,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:s.topic}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[new Date(s.created_at).toLocaleDateString()," â€¢ ",s.session_type.replace("_"," ")]})]})]}),e.jsxs(H,{variant:"outline",children:[s.duration_minutes," min"]})]},a))})})]})]})]})})]})]})})};export{te as default};
