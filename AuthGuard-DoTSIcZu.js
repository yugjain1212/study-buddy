import{c as p,O as V,r as c,j as t,a as H,b as w,i as O,k,h as v,Q as Z,L as _,u as Q}from"./index-Bpmg-vmN.js";import{B as y,u as M,s as K}from"./useAuth-B7xzxMws.js";import{B as W,M as J,Z as X}from"./badge-CHKu4n1O.js";import{B as Y}from"./book-open-BtRnualg.js";/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],te=p("calendar",ee);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],re=p("chevron-left",ae);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ne=p("chevron-right",se);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],ce=p("layout-dashboard",oe);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],le=p("log-out",ie);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],ue=p("moon",de);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],me=p("settings",he);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],pe=p("sun",fe);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ge=p("user",xe);var N={exports:{}},b={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A;function ve(){if(A)return b;A=1;var e=V();function a(o,h){return o===h&&(o!==0||1/o===1/h)||o!==o&&h!==h}var r=typeof Object.is=="function"?Object.is:a,s=e.useState,l=e.useEffect,n=e.useLayoutEffect,f=e.useDebugValue;function d(o,h){var g=h(),j=s({inst:{value:g,getSnapshot:h}}),x=j[0].inst,S=j[1];return n(function(){x.value=g,x.getSnapshot=h,u(x)&&S({inst:x})},[o,g,h]),l(function(){return u(x)&&S({inst:x}),o(function(){u(x)&&S({inst:x})})},[o]),f(g),g}function u(o){var h=o.getSnapshot;o=o.value;try{var g=h();return!r(o,g)}catch{return!0}}function i(o,h){return h()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?i:d;return b.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:m,b}var L;function ye(){return L||(L=1,N.exports=ve()),N.exports}var je=ye();function Se(){return je.useSyncExternalStore(Ne,()=>!0,()=>!1)}function Ne(){return()=>{}}var E="Avatar",[be,Ce]=H(E),[ke,C]=be(E),R=c.forwardRef((e,a)=>{const{__scopeAvatar:r,...s}=e,[l,n]=c.useState("idle");return t.jsx(ke,{scope:r,imageLoadingStatus:l,onImageLoadingStatusChange:n,children:t.jsx(w.span,{...s,ref:a})})});R.displayName=E;var $="AvatarImage",D=c.forwardRef((e,a)=>{const{__scopeAvatar:r,src:s,onLoadingStatusChange:l=()=>{},...n}=e,f=C($,r),d=we(s,n),u=O(i=>{l(i),f.onImageLoadingStatusChange(i)});return k(()=>{d!=="idle"&&u(d)},[d,u]),d==="loaded"?t.jsx(w.img,{...n,ref:a,src:s}):null});D.displayName=$;var q="AvatarFallback",U=c.forwardRef((e,a)=>{const{__scopeAvatar:r,delayMs:s,...l}=e,n=C(q,r),[f,d]=c.useState(s===void 0);return c.useEffect(()=>{if(s!==void 0){const u=window.setTimeout(()=>d(!0),s);return()=>window.clearTimeout(u)}},[s]),f&&n.imageLoadingStatus!=="loaded"?t.jsx(w.span,{...l,ref:a}):null});U.displayName=q;function I(e,a){return e?a?(e.src!==a&&(e.src=a),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function we(e,{referrerPolicy:a,crossOrigin:r}){const s=Se(),l=c.useRef(null),n=s?(l.current||(l.current=new window.Image),l.current):null,[f,d]=c.useState(()=>I(n,e));return k(()=>{d(I(n,e))},[n,e]),k(()=>{const u=o=>()=>{d(o)};if(!n)return;const i=u("loaded"),m=u("error");return n.addEventListener("load",i),n.addEventListener("error",m),a&&(n.referrerPolicy=a),typeof r=="string"&&(n.crossOrigin=r),()=>{n.removeEventListener("load",i),n.removeEventListener("error",m)}},[n,r,a]),f}var z=R,P=D,B=U;const T=c.forwardRef(({className:e,...a},r)=>t.jsx(z,{ref:r,className:v("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...a}));T.displayName=z.displayName;const F=c.forwardRef(({className:e,...a},r)=>t.jsx(P,{ref:r,className:v("aspect-square h-full w-full",e),...a}));F.displayName=P.displayName;const G=c.forwardRef(({className:e,...a},r)=>t.jsx(B,{ref:r,className:v("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...a}));G.displayName=B.displayName;function Ee(){const e=()=>{if(typeof window>"u")return!0;const s=localStorage.getItem("theme");return s==="light"?!1:s==="dark"?!0:window.matchMedia("(prefers-color-scheme: dark)").matches},[a,r]=c.useState(e);return c.useEffect(()=>{const s=document.documentElement;a?(s.classList.add("dark"),localStorage.setItem("theme","dark")):(s.classList.remove("dark"),localStorage.setItem("theme","light"))},[a]),{isDark:a,toggle:()=>r(s=>!s)}}function _e({collapsed:e,className:a=""}){const{isDark:r,toggle:s}=Ee();return t.jsxs(y,{variant:"ghost",size:"sm",onClick:s,className:v("w-full justify-start hover:bg-secondary",a,e?"px-2":"px-3"),children:[r?t.jsx(pe,{className:v("w-5 h-5",e?"":"mr-3")}):t.jsx(ue,{className:v("w-5 h-5",e?"":"mr-3")}),!e&&t.jsx("span",{className:"text-sm font-medium",children:r?"Light Mode":"Dark Mode"})]})}const Re=()=>{const[e,a]=c.useState(!1),[r,s]=c.useState(null),l=Z(),{user:n}=M();c.useEffect(()=>{(async()=>{if(n)try{const{data:m,error:o}=await K.from("profiles").select("full_name").eq("id",n.id).single();if(o&&o.code!=="PGRST116"){console.error("Error fetching profile:",o);return}s(m)}catch(m){console.error("Error fetching user profile:",m)}})()},[n]);const f=()=>r!=null&&r.full_name?r.full_name:n!=null&&n.email?n.email.split("@")[0]:"User",d=()=>f().split(" ").map(m=>m[0]).join("").toUpperCase().slice(0,2),u=[{icon:ce,label:"Dashboard",path:"/dashboard"},{icon:J,label:"AI Tutor",path:"/tutor"},{icon:te,label:"Study Planner",path:"/planner"},{icon:X,label:"Quizzes",path:"/quizzes"},{icon:ge,label:"Profile",path:"/profile"},{icon:me,label:"Settings",path:"/settings"}];return t.jsxs("div",{className:`bg-card border-r border-border transition-all duration-300 ${e?"w-16":"w-64"} flex flex-col h-screen`,children:[t.jsx("div",{className:"p-4 border-b border-border",children:t.jsxs("div",{className:"flex items-center justify-between",children:[!e&&t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:t.jsx(Y,{className:"w-5 h-5 text-primary-foreground"})}),t.jsx("span",{className:"text-lg font-semibold text-foreground",children:"Study Buddy AI"})]}),t.jsx(y,{variant:"ghost",size:"sm",onClick:()=>a(!e),className:"p-2 hover:bg-secondary",children:e?t.jsx(ne,{className:"w-4 h-4"}):t.jsx(re,{className:"w-4 h-4"})})]})}),!e&&t.jsx("div",{className:"p-4 border-b border-border",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs(T,{className:"w-10 h-10",children:[t.jsx(F,{src:"/placeholder.svg",alt:"User"}),t.jsx(G,{className:"bg-primary text-primary-foreground text-sm",children:d()})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:f()}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"CS Student"}),t.jsx(W,{variant:"secondary",className:"text-xs px-1 py-0",children:"Pro"})]})]})]})}),t.jsx("nav",{className:"flex-1 p-4",children:t.jsx("ul",{className:"space-y-1",children:u.map(i=>{const m=l.pathname===i.path;return t.jsx("li",{children:t.jsx(_,{to:i.path,children:t.jsxs(y,{variant:"ghost",className:`w-full justify-start h-10 ${m?"bg-primary text-primary-foreground hover:bg-primary/90":"text-muted-foreground hover:text-foreground hover:bg-secondary"} ${e?"px-2":"px-3"}`,children:[t.jsx(i.icon,{className:`w-5 h-5 ${e?"":"mr-3"}`}),!e&&t.jsx("span",{className:"text-sm font-medium",children:i.label})]})})},i.path)})})}),t.jsxs("div",{className:"p-4 border-t border-border space-y-2",children:[t.jsx(_,{to:"/",children:t.jsxs(y,{variant:"ghost",className:`w-full justify-start text-muted-foreground hover:text-foreground hover:bg-secondary ${e?"px-2":"px-3"}`,children:[t.jsx(le,{className:`w-5 h-5 ${e?"":"mr-3"}`}),!e&&t.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})}),t.jsx(_e,{collapsed:e})]})]})},$e=({children:e})=>{const{user:a,loading:r}=M(),s=Q();return c.useEffect(()=>{console.log("AuthGuard - user:",a,"loading:",r),!r&&!a&&(console.log("AuthGuard - redirecting to login"),s("/login"))},[a,r,s]),r?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):a?t.jsx(t.Fragment,{children:e}):null};export{$e as A,ne as C,le as L,ue as M,Re as S,ge as U,te as a,re as b,me as c,pe as d,T as e,F as f,G as g};
